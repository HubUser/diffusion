      SUBROUTINE ZP10R(NP,A,ROOT,DA,DZ,IERR)
      DIMENSION A(1),ROOT(1),DA(1),DZ(1),AC(2),ACL(2),ACF(2)
     1,ACF1(2),ACF2(2),ACDIR(2)
      INTEGER NP,IERR,TANJA,IFOVFL,N,N1,NP1,NLM,NTOM,I,I1,
     1ISC,ITER,IKER,IIER,IJER,LSW,J,K,MAX0,L
      REAL A,DA,DZ,AC,ACL,ACF,ACF1,ACF2,ACDIR,ABDIR,ABDIRO,
     1ABSCL,ABX,DT,DT1,DX,DX2,DXT,DY,DR,DV,DSC,DZERO,DTWO,
     1DZ0R,DZ0I,DZNI,DZNR,S,S1,SC,SINFT,SETASQ,XN,XN1,XN2,
     1X2N,XN2N,X2N1,XTAN,R,RO,RTN,RNINE,SYS063,T,THETA,
     1THREE,TENM3,W,E,V,FN,FEJER,F0,G,GO,X2,X,HALF,OPTFM,
     1GAMA,ONE,PHI,ZERO,SYS038,SYS051,F,SYS059,SYS065,
     1SYS071,T1,TWO,SINFSQ,SYS093,SYS095,ALOG,ABS,AMIN1,
     1AMAX1,AIMAG,REAL,EXP,SQRT
      COMPLEX ROOT,CMPLX,CONJG,CF1,CF2,CF,CDIRO,CSPIR,CDIR,
     1C,CL
      LOGICAL STARTD,SPIRAL
      COMMON /PP10R/TANJA
      EQUIVALENCE(CF1,ACF1(1)),(CF2,ACF2(1)),(CF,ACF(1)),
     *(CDIR,ACDIR(1)),(C,AC(1)),(CL,ACL(1))
      DATA  GAMA/0.5/,THETA/1.0/,PHI/0.2/,ZERO/0.0/,
     1ONE/1.0/,TWO/2.0/,TENM3/1.0E-3/,DZERO/0.0E0/,THREE/
     13.0/,RNINE/9.0/,DTWO/2.0E0/,HALF/0.5/,OPTFM/-1.25/,
     1SYS038/0.6666667/,SYS051/1.192093E-07/,SYS059/3.4E38/,
     1SYS063/2./,SYS065/6.931472E-1/,SYS071/1.844674E19/,
     1SYS093/0.999999/,SYS095/1.000001/
      F0=0.0
      SINFSQ=SQRT(SYS071)
      SINFT=SINFSQ
      SETASQ=ONE/SINFSQ
      IERR=0
      N=NP
      NP1=N+1
      IF(N.GT.0) GO TO 1
      IERR=65
      GO TO 52
    1 CONTINUE
      DO 2 I=1,NP1
      I1=NP1-I+1
      DA(I)=A(I1)
    2 CONTINUE
      IF(N.LE.2) GO TO 12
      ASSIGN 16 TO LSW
      SC=ZERO
      DO 3 I=1,NP1
      SC=AMAX1(SC,ABS(DA(I)))
    3 CONTINUE
      IF(SC.EQ.ZERO) GO TO 5
      ISC=ALOG(SC)/SYS065+1.E0
      SC=SYS063**ISC
      DSC=SC
      IF(SC.GE.SINFT) GO TO 5
      SC=SINFT/SC
      DSC=SC
      DO 4 I=1,NP1
      DA(I)=DSC*DA(I)
    4 CONTINUE
    5 DO 6 I=1,NP1
      IF(DA(I).NE.ZERO) GO TO 7
      J=NP1-I
      ROOT(J)=CMPLX(SYS059,ZERO)
    6 CONTINUE
      IERR=66
      GO TO 52
    7 IF(I.EQ.1) GO TO 12
      IERR=66
      DO 8 K=I,NP1
      J=K-I
      DA(J+1)=DA(K)
    8 CONTINUE
      N=N-I
      N=N+1
      GO TO 11
    9 N=N1
   10 N=N-1
   11 NP1=N+1
      ASSIGN 16 TO LSW
   12 CONTINUE
      ITER=0
      IF(N-2) 13,14,15
   13 ROOT(1)=CMPLX(-DA(2)/DA(1),ZERO)
      GO TO 52
   14 CALL ZP14R(DA(1),DA(2),DA(3),ROOT(2),ROOT(1),IIER)
      IF(IIER.NE.0) IERR=66
      GO TO 52
   15 IF(DA(NP1).NE.ZERO) GO TO LSW,(16,19)
      ROOT(N)=CMPLX(ZERO,ZERO)
      GO TO 10
   16 CONTINUE
      XN=N
      XN1=XN-ONE
      XN2=XN1-ONE
      X2N=TWO/XN
      X2N1=X2N/XN1
      XN2N=XN2/XN
      N1=N-1
      RTN=SQRT(XN)
      G=EXP((ALOG(ABS(DA(NP1)))-ALOG(ABS(DA(1))))/XN+TENM3)
      R=DA(N)/DA(NP1)
      TANJA=1
      CALL ZP14R(X2N1*DA(N-1),X2N*DA(N),DA(NP1),C,CF1,IKER)
      R=XN2N*R
      TANJA=0
      IF(IKER.EQ.65) CDIRO=CMPLX(AC(1)/XN1,ZERO)
      IF(IKER.NE.65) CDIRO=C/CMPLX(R*AC(1)+XN1, R*AC(2))
      ABDIRO=ABS(REAL(CDIRO))+ABS(AIMAG(CDIRO))
      G=AMIN1(G,SYS095*AMIN1(ABS(AC(1))+ABS(AC(2)), RTN*
     1ABDIRO))
      R=G
   17 T=ABS(DA(1))
      S=ZERO
      DO 18 I=2,N
      S=R*S+T
      T=R*T+ABS(DA(I))
   18 CONTINUE
      S=R*S+T
      T=(R*T-ABS(DA(NP1)))/S
      S=R
      R=R-T
      IF(R.LT.S) GO TO 17
      GO=AMIN1(1.445*XN*R,G)
      RO=SYS093*S
      ASSIGN 19 TO LSW
   19 CONTINUE
      FEJER=GO
      G=GO
      CDIR=CDIRO
      DZNR=DZERO
      ABDIR=ABDIRO
      DZNI=DZERO
      FN=ABS(DA(NP1))
      SPIRAL=.FALSE.
      STARTD=.FALSE.
   20 CONTINUE
      IF(ABDIR.LE.G*GAMA) GO TO 21
      IF(ABDIR.GT.G*THETA) GO TO 42
      IF(.NOT.(STARTD.OR.SPIRAL).AND.RO.GT.GAMA*G) GO TO 21
      V=GAMA*(G/ABDIR)
      CDIR=CMPLX(V*ACDIR(1),V*ACDIR(2))
      ABDIR=ABDIR*V
   21 CONTINUE
      G=FEJER
      CL=CDIR
      ABSCL=ABDIR
      F0=FN
      DZ0R=DZNR
      DZ0I=DZNI
      STARTD=.TRUE.
   22 DZNR=DZ0R+ACL(1)
      DZNI=DZ0I+ACL(2)
   23 CONTINUE
      ITER=ITER+1
      IF(ITER.GT.200*NP) GO TO 43
      IF(ABS(DZNI).LE.PHI*ABSCL) GO TO 34
      S=ZERO
      S1=ZERO
      DT1=DZERO
      T1=ZERO
      DT=DA(1)
      J=3
      DX=DZNR
      DY=DZNI
      SC=CABS(CMPLX(DX,DY))
      DSC=SC
      IF(SC.GE.SINFSQ.OR.SC.LE.SETASQ) GO TO 27
      DX2=DX+DX
      X2=DX2
      DR=DX*DX+DY*DY
      R=DR
      DZ(1)=DA(2)+DX2*DA(1)
      DZ(2)=DA(3)+(DX2*DZ(1)-DR*DA(1))
      IF(J.LT.N) GO TO 25
   24 DX2=DX
      X2=DX2
      J=N
   25 NLM=MAX0(N1,J)
      DO 26 I=J,NLM
      V=S1*R
      S1=S
      S=T1+(X2*S-V)
      DV=DT1*DR
      DT1=DT
      T1=DT1
      DT=(DX2*DT-DV)+DZ(I-2)
      DZ(I)=DA(I+1)+(DX2*DZ(I-1)-DR*DZ(I-2))
   26 CONTINUE
      IF(J.LT.N) GO TO 24
      GO TO 31
   27 DX=DX/DSC
      DY=DY/DSC
      DR=(DX*DX+DY*DY)*DSC
      DZ(1)=DA(2)+(DX2*DA(1))*DSC
      R=DR
      DX2=DX+DX
      X2=DX2
      DZ(2)=DA(3)+(DX2*DZ(1)-DR*DA(1))*DSC
      IF(J.LT.N) GO TO 29
   28 DX2=DX
      X2=DX2
      J=N
   29 NLM=MAX0(N1,J)
      DO 30 I=J,NLM
      V=S1*R
      S1=S
      S=T1+(X2*S-V)*DSC
      DV=DT1*DR
      DT1=DT
      T1=DT1
      DV=DX2*DT-DV
      DT=DZ(I-2)+DV*DSC
      DZ(I)=DA(I+1)+(DX2*DZ(I-1)-DR*DZ(I-2))*DSC
   30 CONTINUE
      IF(J.LT.N) GO TO 28
   31 CF=CMPLX(DZ(NLM),DZNI*DZ(NLM-1))
      FN=CABS(CF)
      E=ABS(DA(1))
      DO 32 I=2,N1
      E=ABS(DZ(I-1))+SC*E
   32 CONTINUE
      E=SYS051*((RNINE*E*SC+THREE*ABS(DZ(N-1)))*SC+ABS(DZ(N)
     1))
      IF(FN.LE.E) GO TO 38
      IF(FN.GE.F0.AND.STARTD) GO TO 42
      DV=DTWO*DZNI
      V=DV
      T=DT
      CF1=CMPLX(DZ(NLM-1)-(DV*(DT1*DZNI)), DV*DT)
      CF2=CMPLX(T-V*(V*S), DZNI*(3.*T1-V*(V*S1)))
      IF(CABS(CF).GE.ONE) GO TO 33
      XTAN=CABS(CF1)/CABS(CF)
   33 C=CF1/CF
      CALL ZP14C(CMPLX(X2N1*ACF2(1),X2N1*ACF2(2)),CMPLX(X2N*
     1ACF1(1),X2N*ACF1(2)),CF,CDIR,CF1,IJER)
      FEJER=ABS(ACDIR(1))+ABS(ACDIR(2))
      C=CMPLX(XN2N*AC(1),XN2N*AC(2))
      C=C*CDIR
      C=CMPLX(AC(1)+XN1,AC(2))
      CDIR=CDIR/C
      ABDIR=ABS(ACDIR(1))+ABS(ACDIR(2))
      FEJER=AMIN1(RTN*ABDIR,FEJER)
      DX=ABS(DZNR)+ABS(DZNI)
      DXT=DX+ABDIR
      IF(DXT-DX.EQ.ZERO) GO TO 38
      GO TO 20
   34 CONTINUE
      DX=DZNR
      X=DX
      DZNI=DZERO
      ABX=ABS(X)
      DV=DA(1)
      V=DV
      W=ZERO
      DZ(1)=DA(2)+DX*DA(1)
      DO 35 I=2,N
      W=V+X*W
      DV=DZ(I-1)+DX*DV
      V=DV
      DZ(I)=DA(I+1)+DX*DZ(I-1)
   35 CONTINUE
      F=DZ(N)
      FN=ABS(F)
      E=ABS(DA(1))*SYS038
      DO 36 I=1,N1
      E=ABS(DZ(I))+ABX*E
   36 CONTINUE
      E=SYS051*(THREE*ABX*E+ABS(DZ(N)))
      IF(FN.LE.E) GO TO 40
      IF(FN.GE.F0.AND.STARTD) GO TO 42
      IF(ABS(F).GE.ONE) GO TO 37
      XTAN=ABS(V)/ABS(F)
   37 R=V/F
      CALL ZP14R(X2N1*W,X2N*V,F,C,CF1,IKER)
      FEJER=ABS(AC(1))+ABS(AC(2))
      R=XN2N*R
      CDIR=C/CMPLX(R*AC(1)+XN1, R*AC(2))
      ABDIR=ABS(ACDIR(1))+ABS(ACDIR(2))
      FEJER=AMIN1(RTN*ABDIR,FEJER)
      DX=ABS(DZNR)
      DXT=DX+ABDIR
      IF(DXT-DX.EQ.ZERO) GO TO 40
      GO TO 20
   38 DO 39 I=3,N
      DA(I-1)=DZ(I-2)
   39 CONTINUE
      ROOT(N)=CMPLX(DZNR,DZNI)
      ROOT(N-1)=CONJG(ROOT(N))
      GO TO 9
   40 DO 41 I=2,N
      DA(I)=DZ(I-1)
   41 CONTINUE
      ROOT(N)=CMPLX(DZNR,ZERO)
      GO TO 10
   42 CONTINUE
      IF(.NOT.STARTD) GO TO 48
      ABSCL=HALF*ABSCL
      CL=CMPLX(HALF*ACL(1),HALF*ACL(2))
      DX=ABS(DZNR)+ABS(DZNI)
      DXT=DX+ABSCL
      IF(DXT-DX.NE.ZERO) GO TO 22
      IF(FN.LT.E*XN*XN) GO TO 47
   43 CONTINUE
      IF(N.EQ.NP) GO TO 45
      DO 44 I=NP1,NP
      L=I-N
      ROOT(L)=ROOT(I)
   44 CONTINUE
   45 NTOM=NP-N+1
      DO 46 I=NTOM,NP
      ROOT(I)=CMPLX(SYS059,ZERO)
   46 CONTINUE
      IF(ITER.GT.200*NP) GO TO 51
      IERR=67
      GO TO 52
   47 IF(DZNI) 38,40,38
   48 CONTINUE
      IF(SPIRAL) GO TO 49
      SPIRAL=.TRUE.
      CSPIR=CMPLX(OPTFM/XN,ONE)
      ABSCL=RO/(XN*XN)
      C=CMPLX((ACDIR(1)/ABDIR)*RO,(ACDIR(2)/ABDIR)*RO)
      GO TO 50
   49 C=CSPIR*CMPLX(DZNR,DZNI)
   50 DZNR=AC(1)
      DZNI=AC(2)
      GO TO 23
   51 IERR=68
   52 CONTINUE
      IF(IERR.GT.0) CALL UTZP10(IERR,10)
      RETURN
      END
